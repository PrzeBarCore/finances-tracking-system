<div class="container">
  <form
    (ngSubmit)="!receiptForm.invalid && saveReceipt()"
    #receiptForm="ngForm"
  >
    <div class="row mt-3">
      <fieldset class="form-group col-auto">
        <label>Date</label>
        <input
          class="form-control"
          type="date"
          name="issuedOnDate"
          [ngModel]="receipt.issuedOnDate | date : 'yyyy-MM-dd'"
          (ngModelChange)="receipt.issuedOnDate = $event"
        />
      </fieldset>
      <fieldset class="form-group col-auto">
        <label>Shop</label>
        <input class="form-control" type="text" name="shop" />
      </fieldset>
    </div>
    <table class="table table-striped">
      <thead class="thead-light">
        <th style="width: 25%">Item Name</th>
        <th style="width: 10%">Quantity</th>
        <th style="width: 10%">Price</th>
        <th style="width: 10%">Discount</th>
        <th style="width: 15%">Product Category</th>
        <th style="width: 15%">Product</th>
        <th style="width: 15%"></th>
      </thead>
      <tbody class="table-group-divider">
        <tr
          *ngFor="let item of receipt.listOfItems; let indexOfelement = index"
        >
          <td>
            <p *ngIf="!item.isEdited">{{ item.name }}</p>
            <input
              *ngIf="item.isEdited"
              type="text"
              [(ngModel)]="item.name"
              name="name"
              class="form-control"
            />
          </td>
          <td>
            <p *ngIf="!item.isEdited">{{ item.quantity }}</p>
            <input
              *ngIf="item.isEdited"
              type="number"
              [(ngModel)]="item.quantity"
              name="quantity"
              class="form-control"
            />
          </td>
          <td>
            <p *ngIf="!item.isEdited">{{ item.regularPrice }}</p>
            <input
              *ngIf="item.isEdited"
              type="number"
              [(ngModel)]="item.regularPrice"
              name="regularPrice"
              class="form-control"
            />
          </td>
          <td>
            <p *ngIf="!item.isEdited">{{ item.discount }}</p>
            <input
              *ngIf="item.isEdited"
              type="number"
              [(ngModel)]="item.discount"
              name="discount"
              class="form-control"
            />
          </td>
          <td>
            <p *ngIf="!item.isEdited">{{ item.productCategoryId }}</p>
            <input
              *ngIf="item.isEdited"
              type="text"
              [(ngModel)]="item.productCategoryId"
              name="productCategoryId"
              class="form-control"
            />
          </td>
          <td>
            <p *ngIf="!item.isEdited">{{ item.productId }}</p>
            <input
              *ngIf="item.isEdited"
              type="text"
              [(ngModel)]="item.productId"
              name="productId"
              class="form-control"
            />
          </td>
          <td name="buttons">
            <button
              *ngIf="!item.isEdited"
              class="mr-1 btn btn-warning rounded-circle"
              (click)="toggleEdition(indexOfelement)"
            >
              <fa-icon [icon]="['far', 'pen-to-square']"></fa-icon>
            </button>
            <button
              *ngIf="item.isEdited"
              class="mr-1 btn btn-success rounded-circle"
              (click)="saveItem(indexOfelement)"
            >
              <fa-icon [icon]="['fas', 'check']"></fa-icon>
            </button>
            <button
              *ngIf="this.receipt.listOfItems.length > 1"
              class="btn btn-danger rounded-circle"
              (click)="removeItem(indexOfelement)"
            >
              <fa-icon [icon]="['fas', 'eraser']"></fa-icon>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
    <button class="btn btn-primary fill" (click)="addItem()">Add Item</button>
    <div class="mt-5 container row">
      <p class="col">Total value: {{ receipt.totalValue }}</p>
      <p class="col">Total Discount: {{ receipt.totalDiscount }}</p>
    </div>
    <input class="form-control mb-5 mt-5" type="file" id="formFile" />

    <button type="submit" class="btn btn-success">Save changes</button>
  </form>
</div>
